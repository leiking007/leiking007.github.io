---
title: "æ ‘èŽ“æ´¾"
date: 2021-11-01
lastmod: 2021-11-11
draft: false
tags: ['æœåŠ¡å™¨']
categories: ["ðŸ§æœåŠ¡å™¨è¿ç»´"]
author: "lei"
---

# æ ‘èŽ“æ´¾

## å®‰è£…archlinuxarm

1. é•œåƒç«™ä¸‹è½½`ArchLinuxARM-rpi-aarch64-latest.tar.gz`

2. TFå¡è¿žæŽ¥linuxè™šæ‹Ÿæœº

3. åˆ†åŒº

   ```bash
   $ sudo fdisk -l ## æŸ¥çœ‹SDå¡çš„è®¾å¤‡å
   $ sudo fdisk /dev/sdX ## å¯¹SDè¿›è¡Œåˆ†åŒº,å°†sdXæ›¿æ¢ä¸ºSDå¡çš„è®¾å¤‡å
    
   æ¬¢è¿Žä½¿ç”¨ fdisk (util-linux 2.34)ã€‚
   æ›´æ”¹å°†åœç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°æ‚¨å†³å®šå°†æ›´æ”¹å†™å…¥ç£ç›˜ã€‚
   ä½¿ç”¨å†™å…¥å‘½ä»¤å‰è¯·ä¸‰æ€ã€‚
    
   å‘½ä»¤(è¾“å…¥ m èŽ·å–å¸®åŠ©)ï¼šo
   åˆ›å»ºäº†ä¸€ä¸ªç£ç›˜æ ‡è¯†ç¬¦ä¸º 0xe303deb5 çš„æ–° DOS ç£ç›˜æ ‡ç­¾ã€‚
    
   å‘½ä»¤(è¾“å…¥ m èŽ·å–å¸®åŠ©)ï¼šn
   åˆ†åŒºç±»åž‹
      p   ä¸»åˆ†åŒº (0ä¸ªä¸»åˆ†åŒºï¼Œ0ä¸ªæ‰©å±•åˆ†åŒºï¼Œ4ç©ºé—²)
      e   æ‰©å±•åˆ†åŒº (é€»è¾‘åˆ†åŒºå®¹å™¨)
   é€‰æ‹© (é»˜è®¤ p)ï¼š
    
   å°†ä½¿ç”¨é»˜è®¤å›žåº” pã€‚
   åˆ†åŒºå· (1-4, é»˜è®¤  1):
   ç¬¬ä¸€ä¸ªæ‰‡åŒº (2048-62333951, é»˜è®¤ 2048):
   æœ€åŽä¸€ä¸ªæ‰‡åŒºï¼Œ+/-sectors æˆ– +size{K,M,G,T,P} (2048-62333951, é»˜è®¤ 62333951): +128M
    
   åˆ›å»ºäº†ä¸€ä¸ªæ–°åˆ†åŒº 1ï¼Œç±»åž‹ä¸ºâ€œLinuxâ€ï¼Œå¤§å°ä¸º 128 MiBã€‚
    
   å‘½ä»¤(è¾“å…¥ m èŽ·å–å¸®åŠ©)ï¼št
   å·²é€‰æ‹©åˆ†åŒº 1
   Hex ä»£ç (è¾“å…¥ L åˆ—å‡ºæ‰€æœ‰ä»£ç )ï¼šc
   å·²å°†åˆ†åŒºâ€œLinuxâ€çš„ç±»åž‹æ›´æ”¹ä¸ºâ€œW95 FAT32 (LBA)â€ã€‚
    
   å‘½ä»¤(è¾“å…¥ m èŽ·å–å¸®åŠ©)ï¼šn
   åˆ†åŒºç±»åž‹
      p   ä¸»åˆ†åŒº (1ä¸ªä¸»åˆ†åŒºï¼Œ0ä¸ªæ‰©å±•åˆ†åŒºï¼Œ3ç©ºé—²)
      e   æ‰©å±•åˆ†åŒº (é€»è¾‘åˆ†åŒºå®¹å™¨)
   é€‰æ‹© (é»˜è®¤ p)ï¼š
    
   å°†ä½¿ç”¨é»˜è®¤å›žåº” pã€‚
   åˆ†åŒºå· (2-4, é»˜è®¤  2):
   ç¬¬ä¸€ä¸ªæ‰‡åŒº (264192-62333951, é»˜è®¤ 264192):
   æœ€åŽä¸€ä¸ªæ‰‡åŒºï¼Œ+/-sectors æˆ– +size{K,M,G,T,P} (264192-62333951, é»˜è®¤ 62333951):
    
   åˆ›å»ºäº†ä¸€ä¸ªæ–°åˆ†åŒº 2ï¼Œç±»åž‹ä¸ºâ€œLinuxâ€ï¼Œå¤§å°ä¸º 29.6 GiBã€‚
    
   å‘½ä»¤(è¾“å…¥ m èŽ·å–å¸®åŠ©)ï¼šw
   åˆ†åŒºè¡¨å·²è°ƒæ•´ã€‚
   å°†è°ƒç”¨ ioctl() æ¥é‡æ–°è¯»åˆ†åŒºè¡¨ã€‚
   æ­£åœ¨åŒæ­¥ç£ç›˜ã€‚
    
   $ sudo mkfs.vfat /dev/sdX1
   $ mkdir boot
   $ sudo mount /dev/sdX1 boot
   $ sudo mkfs.ext4 /dev/sdX2
   $ mkdir root
   $ sudo mount /dev/sdX2 root
   $ sudo df  #æŸ¥çœ‹æŒ‚è½½æƒ…å†µ
   $ sudo bsdtar -xpf ArchLinuxARM-rpi-4-latest.tar.gz -C root
   $ sync  #åˆ·æ–°ç¼“å†²åŒº
   $ sudo mv root/boot/* boot
   #$ sudo sed -i 's/mmcblk0/mmcblk1/g' root/etc/fstab  #arm64ç‰¹æœ‰æ­¥éª¤
   $ sudo umount root boot  #å–æ¶ˆæŒ‚è½½
   ```

4. TFå¡æ’å…¥æ ‘èŽ“æ´¾å¼€æœºï¼Œé€šè¿‡ç½‘çº¿ï¼Œsshè¿œç¨‹ç™»é™†ä¸ŠåŽ»

   ```tex
   æ™®é€šç”¨æˆ·alarmæ¥ç™»å½•, é»˜è®¤å¯†ç æ˜¯alarm
    rootç”¨æˆ·çš„é»˜è®¤å¯†ç æ˜¯rootï¼Œé»˜è®¤ä¸å…è®¸rootè¿œç¨‹ç™»å½•
   ```

5. åˆå§‹åŒ–

   ```bash
   vi /etc/pacman.d/mirrorlist  #æ›´æ–°æº
   pacman-key --init   #åˆå§‹åŒ–
   pacman-key --populate archlinuxarm
   pacman -Syyu  #æ›´æ–°ç³»ç»Ÿ
   ```

6. å¸¸ç”¨è®¾ç½®

   ```bash
   pacman -S vim networkmanager #å®‰è£…vimï¼Œnetworkmanager
   systemctl enable NetworkManager
   systemctl start NetworkManager
   
   #è®¾ç½®æ—¶åŒº
   vim /etc/locale.gen  ## å–æ¶ˆæ³¨é‡Š"en_US.UTF-8 UTF-8"å’Œ"zh_CN.UTF-8 UTF-8"
   locale-gen
   echo "LANG=zh_CN.UTF-8" > /etc/locale.conf
   ln -fs /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
   ```



